{# app/templates/blog_accounts.html #}
{% extends "base.html" %}
{% block title %}å¤–éƒ¨ãƒ–ãƒ­ã‚°ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ{% endblock %}

{% block content %}
<h2 class="text-2xl font-bold mb-6">ğŸ“’ å¤–éƒ¨ãƒ–ãƒ­ã‚°ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</h2>

{% if accts %}
<table class="w-full text-sm">
  <thead class="bg-gray-100">
    <tr>
      <th class="px-2 py-2">ãƒ–ãƒ­ã‚°</th>
      <th class="px-2 py-2">ãƒ¦ãƒ¼ã‚¶ãƒ¼å</th>
      <th class="px-2 py-2">ãƒ¡ãƒ¼ãƒ«</th>
      <th class="px-2 py-2">çŠ¶æ…‹</th>
      <th class="px-2 py-2 text-right">æ“ä½œ</th>
    </tr>
  </thead>
  <tbody>
    {% for a in accts %}
    <tr class="border-b">
      <!-- ãƒ–ãƒ­ã‚°ç¨®åˆ¥ (note / hatena â€¦) -->
      <td class="px-2 py-2">{{ a.blog_type.value|capitalize }}</td>

      <!-- ãƒ–ãƒ­ã‚°å´ãƒ¦ãƒ¼ã‚¶ãƒ¼å -->
      <td class="px-2 py-2 font-mono">{{ a.username }}</td>

      <!-- ç™»éŒ²ãƒ¡ãƒ¼ãƒ«ï¼ˆè¤‡åˆåŒ–è¡¨ç¤ºï¼‰ -->
      <td class="px-2 py-2 font-mono">{{ decrypt(a.email) }}</td>

      <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º -->
      <td class="px-2 py-2">
        {% if a.status == 'active' %}
          <span class="text-green-600">active</span>
        {% else %}
          <span class="text-red-600">{{ a.status }}</span>
        {% endif %}
      </td>

      <!-- æ“ä½œãƒœã‚¿ãƒ³ -->
      <td class="px-2 py-2 text-right">
        {# â–¼ â‘  ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ãƒ­ã‚°ã‚¤ãƒ³ #}
        <form action="{{ url_for('main.blog_login') }}" method="post" class="inline">
          <input type="hidden" name="account_id" value="{{ a.id }}">
          <button
            type="submit"
            class="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded text-xs">
            ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ãƒ­ã‚°ã‚¤ãƒ³
          </button>
        </form>

        {# â–¼ â‘¡ è³‡æ ¼æƒ…å ±ã‚³ãƒ”ãƒ¼ #}
        <button
          type="button"
          class="ml-2 px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded text-xs copy-cred"
          data-user="{{ a.username }}"
          data-pass="{{ decrypt(a.password) }}">
          ID/Pass ã‚³ãƒ”ãƒ¼
        </button>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚³ãƒ”ãƒ¼ç”¨ JS -->
<script>
document.querySelectorAll('.copy-cred').forEach(btn => {
  btn.addEventListener('click', () => {
    const user = btn.dataset.user;
    const pass = btn.dataset.pass;
    navigator.clipboard.writeText(`ãƒ¦ãƒ¼ã‚¶ãƒ¼å: ${user}\nãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: ${pass}`);
    btn.textContent = "âœ” ã‚³ãƒ”ãƒ¼å®Œäº†";
    setTimeout(() => (btn.textContent = "ID/Pass ã‚³ãƒ”ãƒ¼"), 2000);
  });
});
</script>
{% else %}
<p class="text-gray-500">ã¾ã å¤–éƒ¨ãƒ–ãƒ­ã‚°ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯ä½œæˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>
{% endif %}
{% endblock %}
