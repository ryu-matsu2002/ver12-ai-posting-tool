{# --------------------------------------------------------------------- #}
{#  _job_progress.html                                                   #}
{#  AIエージェント用（ジョブモデルなし）                                #}
{#  期待変数: site_id, blog                                              #}
{# --------------------------------------------------------------------- #}

{% set blog_label  = blog|capitalize %}
{% set card_id     = "site-card-" ~ site_id %}

<div id="{{ card_id }}" class="border p-4 rounded shadow-sm bg-white">

  <div class="flex items-center justify-between mb-2">
    <div class="font-bold text-gray-800">{{ blog_label }} 外部SEO</div>

    {# 🚀 SEO未開始時：開始ボタンを表示 #}
    {% if blog == "livedoor" %}
      <button
        class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded"
        data-site-id="{{ site_id }}"
        data-blog="{{ blog }}"
        onclick="handleCaptchaClick(this)">
        開始
      </button>
    {% else %}
      <button
        class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded"
        hx-post="{{ url_for('main.start_external_seo') }}"
        hx-vals='{"site_id":"{{ site_id }}","blog":"{{ blog }}"}'
        hx-target="#{{ card_id }}"
        hx-swap="outerHTML">
        開始
      </button>
    {% endif %}
  </div>

  <div class="text-sm text-gray-600">
    AIエージェントが{{ blog_label }}でアカウント登録を試みます。
    処理には30秒前後かかる場合があります。
  </div>

</div>
