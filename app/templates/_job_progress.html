{# templates/_job_progress.html #}

<div id="seo-panel-{{ site_id }}"
     class="w-full"
     hx-get="{{ url_for('main.external_seo_job_status', site_id=site_id) }}"
     hx-trigger="every 5s"
     hx-swap="innerHTML">

  {% if not job %}
    <div class="p-4 bg-gray-100 border rounded text-sm text-gray-600">
      ã‚¸ãƒ§ãƒ–ã‚’é–‹å§‹ã—ã¾ã—ãŸã€‚åæ˜ ã¾ã§æ•°ç§’ãŠå¾…ã¡ãã ã•ã„â€¦
    </div>

  {% else %}
    <div class="p-4 bg-white border rounded shadow">
      <h3 class="font-semibold mb-2">
        {% if job.status == 'running' %}ğŸ› ï¸ å®Ÿè¡Œä¸­â€¦
        {% elif job.status == 'success' %}ğŸ‰ å®Œäº†
        {% else %}âš ï¸ ã‚¨ãƒ©ãƒ¼
        {% endif %}
      </h3>

      <ul class="space-y-1 text-sm">
        <li>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: <span class="font-mono">{{ job.status }}</span></li>
        <li>ã‚¹ãƒ†ãƒƒãƒ—&nbsp;: <span class="font-mono">{{ job.step }}</span></li>
        <li>è¨˜äº‹æ•°&nbsp;: {{ job.article_cnt }} æœ¬</li>

        {% if job.message %}
          <li class="text-red-600">ã‚¨ãƒ©ãƒ¼: {{ job.message }}</li>
        {% endif %}

        <li class="text-gray-500">
          æ›´æ–°: {{ job.updated_at.strftime('%Y-%m-%d %H:%M:%S') }}
        </li>
      </ul>

      {% if job.status == 'success' %}
        <div class="mt-4 flex gap-3">
          <a href="#"
             class="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm">
            æŠ•ç¨¿ä¸€è¦§ã‚’è¦‹ã‚‹
          </a>
        </div>
      {% endif %}
    </div>
  {% endif %}
</div>
