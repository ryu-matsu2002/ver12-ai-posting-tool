{% extends "base.html" %}
{% block title %}外部SEO | サイト一覧{% endblock %}

{% block content %}
<h2 class="text-2xl font-bold mb-6 flex items-center justify-between">
  🚀 外部SEO | サイト一覧
  <a href="{{ url_for('main.my_blog_accounts') }}"
     class="text-sm px-3 py-1 bg-emerald-600 hover:bg-emerald-700 text-white rounded">
    外部ブログアカウント一覧
  </a>
</h2>

{% for s in sites %}
  <div id="site-card-{{ s.id }}" class="border rounded p-4 mb-4">
    <!-- サイト名 & URL -->
    <div class="mb-2">
      <div class="font-semibold truncate max-w-xs">{{ s.name }}</div>
      <a href="{{ s.url }}" class="text-blue-600 text-sm break-all" target="_blank">{{ s.url }}</a>
    </div>

    <!-- ブログ種別ごとの操作 -->
    <div class="flex flex-wrap gap-2 mt-2">
      {% for b in ['note', 'ameba', 'livedoor'] %}
        {% set key = (s.id, b) %}
        {% set job = job_map.get(key) %}

        {# _job_progress.html に blog も渡す #}
        {% include "_job_progress.html" with
           site_id=s.id
           blog=b
           job=job %}
      {% endfor %}
    </div>
  </div>
{% endfor %}
{% endblock %}
