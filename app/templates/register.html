{% extends "register_base.html" %}
{% block title %}Register | AI Posting Tool{% endblock %}

{% block content %}
<div class="min-h-screen flex items-start justify-center bg-gray-100 px-4 pt-4 pb-10 overflow-auto">
  <form method="post"
        class="w-full max-w-md bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md">
    {{ form.hidden_tag() }}

    <h2 class="text-2xl font-semibold mb-6 text-center">新規登録</h2>

    <!-- ユーザー名 -->
    <div class="mb-4">
      {{ form.username.label(class="block mb-1 text-sm font-medium") }}
      {{ form.username(class="w-full p-2 rounded border dark:bg-gray-700 dark:border-gray-600") }}
    </div>

    <!-- メールアドレス -->
    <div class="mb-4">
      {{ form.email.label(class="block mb-1 text-sm font-medium") }}
      {{ form.email(class="w-full p-2 rounded border dark:bg-gray-700 dark:border-gray-600") }}
    </div>

    <!-- パスワード -->
    <div class="mb-4">
      {{ form.password.label(class="block mb-1 text-sm font-medium") }}
      {{ form.password(class="w-full p-2 rounded border dark:bg-gray-700 dark:border-gray-600") }}
    </div>

    <!-- パスワード確認 -->
    <div class="mb-6">
      {{ form.confirm.label(class="block mb-1 text-sm font-medium") }}
      {{ form.confirm(class="w-full p-2 rounded border dark:bg-gray-700 dark:border-gray-600") }}
    </div>

    <!-- 区分 -->
    <div class="mb-6">
      <label class="block mb-1 text-sm font-medium">区分</label>
      {{ form.user_type(class="w-full p-2 rounded border", id="user_type") }}
    </div>

    <!-- 法人用フィールド -->
    <div id="corporate_fields" class="mb-6 hidden">
      <div class="mb-4">
        {{ form.company_name.label(class="block mb-1 text-sm font-medium") }}
        {{ form.company_name(class="w-full p-2 rounded border") }}
      </div>
      <div class="mb-4">
        {{ form.company_kana.label(class="block mb-1 text-sm font-medium") }}
        {{ form.company_kana(class="w-full p-2 rounded border") }}
      </div>
    </div>

    <!-- 氏名 -->
    <div class="flex gap-4 mb-4">
      <div class="w-1/2">
        {{ form.last_name.label(class="block mb-1 text-sm font-medium") }}
        {{ form.last_name(class="w-full p-2 rounded border") }}
      </div>
      <div class="w-1/2">
        {{ form.first_name.label(class="block mb-1 text-sm font-medium") }}
        {{ form.first_name(class="w-full p-2 rounded border") }}
      </div>
    </div>

    <!-- フリガナ -->
    <div class="flex gap-4 mb-4">
      <div class="w-1/2">
        {{ form.last_kana.label(class="block mb-1 text-sm font-medium") }}
        {{ form.last_kana(class="w-full p-2 rounded border") }}
      </div>
      <div class="w-1/2">
        {{ form.first_kana.label(class="block mb-1 text-sm font-medium") }}
        {{ form.first_kana(class="w-full p-2 rounded border") }}
      </div>
    </div>

    <!-- 郵便番号 -->
    <div class="mb-4">
      {{ form.postal_code.label(class="block mb-1 text-sm font-medium") }}
      {{ form.postal_code(class="w-full p-2 rounded border") }}
    </div>

    <!-- 都道府県・市区郡 -->
    <div class="flex gap-4 mb-4">
      <div class="w-1/2">
        {{ form.prefecture.label(class="block mb-1 text-sm font-medium") }}
        {{ form.prefecture(class="w-full p-2 rounded border") }}
      </div>
      <div class="w-1/2">
        {{ form.city.label(class="block mb-1 text-sm font-medium") }}
        {{ form.city(class="w-full p-2 rounded border") }}
      </div>
    </div>

    <!-- 住所 -->
    <div class="mb-4">
      {{ form.address1.label(class="block mb-1 text-sm font-medium") }}
      {{ form.address1(class="w-full p-2 rounded border") }}
    </div>
    <div class="mb-4">
      {{ form.address2.label(class="block mb-1 text-sm font-medium") }}
      {{ form.address2(class="w-full p-2 rounded border") }}
    </div>

    <!-- 電話番号 -->
    <div class="mb-4">
      {{ form.phone.label(class="block mb-1 text-sm font-medium") }}
      {{ form.phone(class="w-full p-2 rounded border") }}
    </div>

    <!-- 登録用キー -->
    <div class="mb-6">
      {{ form.register_key.label(class="block mb-1 text-sm font-medium") }}
      {{ form.register_key(class="w-full p-2 rounded border") }}
      <p class="text-sm text-gray-500 mt-1">※ 登録には「tcctool」という登録専用パスワードが必要です</p>
    </div>

    <!-- 登録ボタン -->
    {{ form.submit(class="w-full py-2 bg-blue-600 hover:bg-blue-700 text-white rounded text-center") }}

    <!-- ログインリンク -->
    <p class="text-center text-sm mt-4">
      既にアカウントをお持ちですか？
      <a href="{{ url_for('main.login') }}" class="text-blue-600 hover:underline">ログイン</a>
    </p>
  </form>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const userTypeSelect = document.getElementById("user_type");
    const corporateFields = document.getElementById("corporate_fields");

    function toggleCorporateFields() {
      if (userTypeSelect.value === "corporate") {
        corporateFields.classList.remove("hidden");
      } else {
        corporateFields.classList.add("hidden");
      }
    }

    userTypeSelect.addEventListener("change", toggleCorporateFields);
    toggleCorporateFields();
  });
</script>
{% endblock %}
