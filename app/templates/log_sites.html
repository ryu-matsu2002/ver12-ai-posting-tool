{% extends "base.html" %}
{% block title %}æŠ•ç¨¿ãƒ­ã‚° - ã‚µã‚¤ãƒˆä¸€è¦§ | AI Posting Tool{% endblock %}

{% block content %}
<h2 class="text-2xl font-semibold mb-6">è¨˜äº‹ç”Ÿæˆ - æŠ•ç¨¿ãƒ­ã‚° - ã‚µã‚¤ãƒˆä¸€è¦§</h2>

<!-- ğŸ”½ ãƒ•ã‚£ãƒ«ã‚¿ç”¨ã‚»ãƒ¬ã‚¯ãƒˆ -->
<form method="get" class="mb-6">
  <label for="status" class="font-medium mr-2">è¡¨ç¤ºã™ã‚‹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:</label>
  <select id="status" name="plan_type" onchange="this.form.submit()" class="p-2 border rounded">
    <option value="all" {% if selected_status == 'all' %}selected{% endif %}>ã™ã¹ã¦ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</option>
    <option value="affiliate" {% if selected_status == 'affiliate' %}selected{% endif %}>ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆç”¨</option>
    <option value="business" {% if selected_status == 'business' %}selected{% endif %}>äº‹æ¥­ç”¨</option>
  </select>
</form>

{% if sites %}
  <table class="w-full table-auto text-sm bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700">
    <thead>
      <tr class="bg-gray-100 dark:bg-gray-700 text-left text-black font-bold text-sm whitespace-nowrap">
        <th class="px-3 py-2">ã‚µã‚¤ãƒˆå</th>
        <th class="px-3 py-2">URL</th>
        <th class="px-3 py-2 text-center">ç·è¨˜äº‹æ•°</th>
        <th class="px-3 py-2 text-center">è¨˜äº‹ç”Ÿæˆæ¸ˆã¿</th>
        <th class="px-3 py-2 text-center">æŠ•ç¨¿å®Œäº†</th>
        <th class="px-3 py-2 text-center">ã‚¨ãƒ©ãƒ¼</th>
        <th class="px-3 py-2 text-center">è©³ç´°</th>
      </tr>
    </thead>
    <tbody>
      {% for site in sites %}
      <tr class="{% if loop.index0 % 2 == 0 %}bg-white{% else %}bg-blue-50{% endif %} border-b dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-900">
        <td class="px-3 py-2 align-top font-medium text-blue-700 dark:text-blue-300">
          [{{ site.name }}]
          {% if site.plan_type == 'affiliate' %}
            <span class="ml-2 inline-block bg-green-600 text-white text-xs font-semibold px-2 py-0.5 rounded">
              ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆç”¨
            </span>
          {% elif site.plan_type == 'business' %}
            <span class="ml-2 inline-block bg-blue-600 text-white text-xs font-semibold px-2 py-0.5 rounded">
              äº‹æ¥­ç”¨
            </span>
          {% endif %}
        </td>
        <td class="px-3 py-2 align-top break-all text-blue-700 underline">
          <a href="{{ site.url }}" target="_blank">{{ site.url }}</a>
          {% if site.gsc_connected %}
            <span class="ml-2 inline-block bg-green-600 text-white text-xs font-semibold px-2 py-0.5 rounded">
              GSCæ¥ç¶šæ¸ˆã¿ âœ…
            </span>
          {% endif %}
        </td>
        <td class="px-3 py-2 text-center text-black">{{ site.total or 0 }}</td>
        <td class="px-3 py-2 text-center text-green-600 font-bold">{{ site.done or 0 }}</td>
        <td class="px-3 py-2 text-center text-blue-600 font-bold">{{ site.posted or 0 }}</td>
        <td class="px-3 py-2 text-center text-red-600 font-bold">{{ site.error or 0 }}</td>
        <td class="px-3 py-2 text-center space-x-1 whitespace-nowrap">
          {% if site.gsc_connected %}
            <a href="{{ url_for('main.gsc_generate', username=current_user.username) }}?site_id={{ site.id }}"
               class="inline-block py-1 px-3 bg-lime-600 hover:bg-lime-700 text-white rounded text-sm">
              GSCç”Ÿæˆ
            </a>
          {% endif %}
          <a href="{{ url_for('main.generate', username=current_user.username) }}?site_id={{ site.id }}"
             class="inline-block py-1 px-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded text-sm">
            è¨˜äº‹ç”Ÿæˆ
          </a>
          <a href="{{ url_for('main.log', username=current_user.username, site_id=site.id) }}"
             class="inline-block py-1 px-3 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm">
            è¨˜äº‹ä¸€è¦§
          </a>
          <a href="{{ site.url.rstrip('/') }}/admin"
             target="_blank"
             class="inline-block py-1 px-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded text-sm">
            WPç®¡ç†
          </a>
          <a href="{{ url_for('main.edit_site', username=current_user.username, sid=site.id) }}"
             class="inline-block py-1 px-3 bg-gray-500 hover:bg-gray-600 text-white rounded text-sm">
            ä¿®æ­£
          </a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% else %}
  <div class="text-gray-500 text-center py-12">
    ã‚µã‚¤ãƒˆãŒã¾ã ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
  </div>
{% endif %}
{% endblock %}
