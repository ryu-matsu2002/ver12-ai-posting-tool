{% extends "base_admin.html" %}
{% block title %}経理ダッシュボード{% endblock %}

{% block content %}
<div class="p-6">
  <h1 class="text-2xl font-bold mb-6">💼 経理ダッシュボード（TCC未購入ユーザー集計）</h1>

  <!-- 💰 集計表示 -->
  <div class="bg-white shadow rounded p-6 mb-6">
    <h2 class="text-lg font-bold mb-4">📊 総集計</h2>
    <ul class="list-disc list-inside space-y-1">
      <li>対象サイト数（TCC未購入ユーザー）：<strong>{{ total_count }}</strong> 件</li>
      <li>松本龍之介への報酬：<strong>{{ total_ryunosuke | comma }} 円</strong>（@1000円）</li>
      <li>松本毅への報酬：<strong>{{ total_takeshi | comma }} 円</strong>（@2000円）</li>
    </ul>
  </div>

  <!-- 📋 月別リスト -->
  <div class="bg-gray-50 p-4 rounded shadow">
    <h3 class="text-md font-bold mb-2">📅 月別内訳</h3>
    <table class="min-w-full border border-gray-300 text-sm text-center bg-white">
      <thead class="bg-gray-100">
        <tr>
          <th class="py-2 px-4 border">年月</th>
          <th class="py-2 px-4 border">サイト数</th>
          <th class="py-2 px-4 border">龍之介（@1000）</th>
          <th class="py-2 px-4 border">毅（@2000）</th>
        </tr>
      </thead>
      <tbody>
        {% for month, data in site_data_by_month.items() %}
        <tr class="hover:bg-gray-50">
          <td class="py-2 px-4 border">{{ month }}</td>
          <td class="py-2 px-4 border">{{ data.site_count }}</td>
          <td class="py-2 px-4 border">{{ data.ryunosuke_income | comma }}</td>
          <td class="py-2 px-4 border">{{ data.takeshi_income | comma }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}

{% macro comma(value) %}
{{ "{:,}".format(value) }}
{% endmacro %}
