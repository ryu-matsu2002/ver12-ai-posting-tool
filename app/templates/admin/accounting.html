{% extends "base_admin.html" %}
{% block title %}çµŒç†ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰{% endblock %}

{% block content %}
<div class="p-8">

  <h1 class="text-3xl font-extrabold mb-8 text-gray-800">
    ğŸ’¼ çµŒç†ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
    <span class="text-sm font-normal text-gray-500">(TCCæœªè³¼å…¥ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã‚‹ã‚µã‚¤ãƒˆæ è³¼å…¥é›†è¨ˆ)</span>
  </h1>

  <!-- ğŸ“… æœˆåˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
  <form method="get" class="mb-6">
    <label for="month" class="font-semibold text-gray-700 mr-2">ğŸ“… è¡¨ç¤ºæœˆï¼š</label>
    <select name="month" id="month" onchange="this.form.submit()" class="border border-gray-300 rounded px-3 py-2 text-sm">
      <option value="all" {% if selected_month == 'all' %}selected{% endif %}>å…¨æœŸé–“</option>
      {% for month in all_months %}
        <option value="{{ month }}" {% if selected_month == month %}selected{% endif %}>{{ month }}</option>
      {% endfor %}
    </select>
  </form>

  <!-- ğŸ’° ç·é›†è¨ˆ -->
  <div class="bg-gray-100 border border-gray-300 rounded-lg p-6 mb-6 shadow-md">
    <h2 class="text-xl font-bold mb-4 text-gray-800">ğŸ“Š ç·é›†è¨ˆ</h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-gray-700">
      <div class="bg-white p-4 rounded shadow text-center">
        <p class="text-sm text-gray-500">è³¼å…¥æ¸ˆã¿ã‚µã‚¤ãƒˆæ æ•°ï¼ˆç™»éŒ²æ¸ˆã¿ï¼‹æœªç™»éŒ²ï¼‰</p>
        <p class="text-xl font-bold text-blue-700">{{ total_count }} ä»¶</p>
      </div>
      <div class="bg-white p-4 rounded shadow text-center">
        <p class="text-sm text-gray-500">æ¾æœ¬é¾ä¹‹ä»‹ï¼ˆ@1000ï¼‰</p>
        <p class="text-xl font-bold text-green-700">{{ total_ryunosuke | comma }} å††</p>
      </div>
      <div class="bg-white p-4 rounded shadow text-center">
        <p class="text-sm text-gray-500">æ¾æœ¬æ¯…ï¼ˆ@2000ï¼‰</p>
        <p class="text-xl font-bold text-purple-700">{{ total_takeshi | comma }} å††</p>
      </div>
    </div>
  </div>

  <!-- ğŸ¦ å…¥é‡‘æƒ…å ±ã¨æ®‹é«˜è¡¨ç¤º -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-10">
    <!-- ğŸ”¢ å…¥é‡‘æ¸ˆã¿/æ®‹é«˜ -->
    <div class="bg-white border rounded-lg shadow-md p-6">
      <h3 class="text-lg font-bold text-gray-700 mb-4">ğŸ’° é¾ä¹‹ä»‹ã®å…¥é‡‘çŠ¶æ³</h3>
      <p class="mb-2 text-gray-600">âœ… å…¥é‡‘æ¸ˆã¿é‡‘é¡ï¼š<span class="font-bold text-green-700">{{ paid_total | comma }} å††</span></p>
      <p class="mb-2 text-gray-600">ğŸ’¸ æ®‹ã‚Šå—å–é¡ï¼š<span class="font-bold text-red-600">{{ remaining | comma }} å††</span></p>
    </div>

    <!-- ğŸ“¥ å…¥é‡‘ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ  -->
    <div class="bg-white border rounded-lg shadow-md p-6">
      <h3 class="text-lg font-bold text-gray-700 mb-4">ğŸ“ é¾ä¹‹ä»‹ã®å…¥é‡‘ã‚’è¨˜éŒ²</h3>
      <form method="POST">
        {{ form.hidden_tag() }}
        <div class="mb-4">
          {{ form.deposit_date.label(class="block text-sm font-semibold text-gray-600 mb-1") }}
          {{ form.deposit_date(class="w-full border px-3 py-2 rounded text-sm") }}
        </div>
        <div class="mb-4">
          {{ form.amount.label(class="block text-sm font-semibold text-gray-600 mb-1") }}
          {{ form.amount(class="w-full border px-3 py-2 rounded text-sm") }}
        </div>
        <div class="mb-4">
          {{ form.memo.label(class="block text-sm font-semibold text-gray-600 mb-1") }}
          {{ form.memo(class="w-full border px-3 py-2 rounded text-sm") }}
        </div>
        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 text-sm shadow">
          ğŸ’¾ å…¥é‡‘ã‚’ç™»éŒ²ã™ã‚‹
        </button>
      </form>
    </div>
  </div>

  <!-- ğŸ”— ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥è³¼å…¥å±¥æ­´ã¸ã®ãƒªãƒ³ã‚¯ -->
  <div class="mb-10 text-right">
    <a href="{{ url_for('admin.accounting_details') }}" class="inline-block bg-blue-600 text-white text-sm font-semibold px-4 py-2 rounded hover:bg-blue-700 shadow">
      ğŸ§¾ ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥ã®è³¼å…¥å±¥æ­´ã‚’è¦‹ã‚‹
    </a>
  </div>

  <!-- ğŸ“‹ æœˆåˆ¥å†…è¨³ -->
  <div class="bg-white border rounded-lg shadow-md">
    <div class="p-4 border-b bg-gray-50 rounded-t">
      <h3 class="text-lg font-bold text-gray-700">ğŸ“… æœˆåˆ¥å†…è¨³</h3>
    </div>
    <div class="overflow-x-auto">
      <table class="min-w-full text-sm text-center">
        <thead class="bg-gray-100 text-gray-700">
          <tr>
            <th class="py-2 px-4 border-b">å¹´æœˆ</th>
            <th class="py-2 px-4 border-b">è³¼å…¥ã‚µã‚¤ãƒˆæ æ•°</th>
            <th class="py-2 px-4 border-b">é¾ä¹‹ä»‹ï¼ˆ@1000ï¼‰</th>
            <th class="py-2 px-4 border-b">æ¯…ï¼ˆ@2000ï¼‰</th>
          </tr>
        </thead>
        <tbody class="text-gray-800">
          {% for month, data in site_data_by_month.items() %}
          <tr class="hover:bg-gray-50">
            <td class="py-2 px-4 border-b">{{ month }}</td>
            <td class="py-2 px-4 border-b">{{ data.site_count }}</td>
            <td class="py-2 px-4 border-b text-green-700">{{ data.ryunosuke_income | comma }}</td>
            <td class="py-2 px-4 border-b text-purple-700">{{ data.takeshi_income | comma }}</td>
          </tr>
          {% else %}
          <tr>
            <td colspan="4" class="py-4 text-gray-500 italic">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

</div>
{% endblock %}
