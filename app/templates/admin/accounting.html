{% extends "base_admin.html" %}
{% block title %}経理ダッシュボード{% endblock %}

{% block content %}
<div class="p-6 space-y-10">

  <h1 class="text-3xl font-bold text-gray-800 border-b pb-2">
    💼 経理ダッシュボード
    <span class="text-sm text-gray-500">（TCC未購入ユーザー集計）</span>
  </h1>

  <!-- 💰 総集計 -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <div class="bg-white p-6 rounded shadow text-center border">
      <div class="text-sm text-gray-500 mb-1">対象サイト数（登録済 + 残枠）</div>
      <div class="text-3xl font-bold text-blue-700 tracking-wider">{{ total_count }}</div>
      <div class="text-xs text-gray-400 mt-1">件</div>
    </div>
    <div class="bg-white p-6 rounded shadow text-center border">
      <div class="text-sm text-gray-500 mb-1">松本龍之介への報酬</div>
      <div class="text-3xl font-bold text-green-600 tracking-wider">{{ total_ryunosuke | comma }}</div>
      <div class="text-xs text-gray-400 mt-1">円（@1000円）</div>
    </div>
    <div class="bg-white p-6 rounded shadow text-center border">
      <div class="text-sm text-gray-500 mb-1">松本毅への報酬</div>
      <div class="text-3xl font-bold text-purple-600 tracking-wider">{{ total_takeshi | comma }}</div>
      <div class="text-xs text-gray-400 mt-1">円（@2000円）</div>
    </div>
  </div>

  <!-- 📅 月別内訳 -->
  <div class="bg-white p-6 rounded shadow border">
    <h2 class="text-xl font-semibold mb-4">📅 月別内訳</h2>

    {% if site_data_by_month %}
    <table class="min-w-full text-sm text-center border border-gray-300">
      <thead class="bg-gray-100 text-gray-700">
        <tr>
          <th class="py-2 px-4 border">年月</th>
          <th class="py-2 px-4 border">サイト数</th>
          <th class="py-2 px-4 border">龍之介（@1000）</th>
          <th class="py-2 px-4 border">毅（@2000）</th>
        </tr>
      </thead>
      <tbody>
        {% for month, data in site_data_by_month.items() %}
        <tr class="hover:bg-gray-50 {% if loop.index is even %}bg-gray-50{% endif %}">
          <td class="py-2 px-4 border">{{ month }}</td>
          <td class="py-2 px-4 border">{{ data.site_count }}</td>
          <td class="py-2 px-4 border">{{ data.ryunosuke_income | comma }}</td>
          <td class="py-2 px-4 border">{{ data.takeshi_income | comma }}</td>
        </tr>
        {% endfor %}
        <!-- ✅ 合計行 -->
        <tr class="bg-yellow-50 font-bold">
          <td class="py-2 px-4 border">合計</td>
          <td class="py-2 px-4 border">{{ total_count }}</td>
          <td class="py-2 px-4 border">{{ total_ryunosuke | comma }}</td>
          <td class="py-2 px-4 border">{{ total_takeshi | comma }}</td>
        </tr>
      </tbody>
    </table>
    {% else %}
      <p class="text-center text-gray-500 mt-6">📭 月別データはまだありません。</p>
    {% endif %}
  </div>

</div>
{% endblock %}
