{% extends "base_admin.html" %}
{% block title %}ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç®¡ç† | ç®¡ç†è€…{% endblock %}

{% block content %}
<h1 class="text-2xl font-bold mb-6">ğŸ”‘ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä¸€è¦§</h1>

<div class="space-y-6">
  {% for user in users %}
    <details class="bg-blue-50 border border-blue-300 rounded p-4">
      <summary class="cursor-pointer font-semibold text-lg text-black flex items-center">
        <span class="material-icons mr-2">person</span>
        {{ user.last_name }} {{ user.first_name }}
        <span class="ml-2 text-sm text-gray-600">ï¼ˆé€šå¸¸: {{ user.keywords|length }}ä»¶ / GSC: {{ user.gsc_keywords|length }}ä»¶ï¼‰</span>
      </summary>

      <!-- ğŸ”· é€šå¸¸ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ -->
      <div class="mt-4">
        <h2 class="font-semibold text-base text-blue-700">ğŸ“ é€šå¸¸ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆ{{ user.keywords|length }}ä»¶ï¼‰</h2>
        {% if user.keywords %}
          <div class="overflow-x-auto mt-2">
            <table class="min-w-full bg-white text-sm border rounded shadow">
              <thead class="bg-gray-100">
                <tr>
                  <th class="px-4 py-2 text-left">ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</th>
                  <th class="px-4 py-2 text-left">ã‚¸ãƒ£ãƒ³ãƒ«</th>
                  <th class="px-4 py-2 text-left">ç™»éŒ²æ—¥</th>
                </tr>
              </thead>
              <tbody>
                {% for kw in user.keywords %}
                  <tr class="border-t">
                    <td class="px-4 py-2">{{ kw.keyword }}</td>
                    <td class="px-4 py-2">{{ kw.genre or "æœªè¨­å®š" }}</td>
                    <td class="px-4 py-2 text-gray-500">{{ kw.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <p class="mt-2 text-gray-600">é€šå¸¸ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>
        {% endif %}
      </div>

      <!-- ğŸŸ¢ GSCã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ -->
      <div class="mt-6">
        <h2 class="font-semibold text-base text-green-700">ğŸ” GSCã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆ{{ user.gsc_keywords|length }}ä»¶ï¼‰</h2>
        {% if user.gsc_keywords %}
          <div class="overflow-x-auto mt-2">
            <table class="min-w-full bg-white text-sm border rounded shadow">
              <thead class="bg-gray-100">
                <tr>
                  <th class="px-4 py-2 text-left">ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</th>
                  <th class="px-4 py-2 text-left">ã‚¸ãƒ£ãƒ³ãƒ«</th>
                  <th class="px-4 py-2 text-left">ç™»éŒ²æ—¥</th>
                </tr>
              </thead>
              <tbody>
                {% for kw in user.gsc_keywords %}
                  <tr class="border-t">
                    <td class="px-4 py-2">
                      {{ kw.keyword }}
                      <span class="ml-1 px-2 py-0.5 bg-blue-500 text-white text-xs rounded">GSC</span>
                    </td>
                    <td class="px-4 py-2">{{ kw.genre or "æœªè¨­å®š" }}</td>
                    <td class="px-4 py-2 text-gray-500">{{ kw.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <p class="mt-2 text-gray-600">GSCã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>
        {% endif %}
      </div>
    </details>
  {% endfor %}
</div>
{% endblock %}
