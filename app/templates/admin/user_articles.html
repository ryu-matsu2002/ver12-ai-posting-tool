{% extends "base_admin.html" %}
{% block title %}ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¨˜äº‹ä¸€è¦§{% endblock %}

{% block content %}
<div class="p-6">
  <h1 class="text-xl font-bold mb-4">ğŸ“ {{ user.email }} ã®è¨˜äº‹ä¸€è¦§</h1>

  <!-- âœ… å‰Šé™¤å¯¾è±¡ä»¶æ•°è¡¨ç¤º + å‰Šé™¤ãƒœã‚¿ãƒ³ -->
  <div class="mb-4 flex items-center gap-4">
    <p class="text-sm text-red-600 font-semibold">
      ğŸš« é€”ä¸­åœæ­¢çŠ¶æ…‹ã®è¨˜äº‹: <span class="text-lg">{{ stuck_count }}</span> ä»¶
    </p>

    {% if stuck_count > 0 %}
    <form method="post" action="{{ url_for('admin.delete_user_stuck_articles', uid=user.id) }}"
          onsubmit="return confirm('é€”ä¸­åœæ­¢ä¸­ã®è¨˜äº‹ï¼ˆpending / genï¼‰ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ');">
      <button type="submit"
              class="py-2 px-6 bg-red-600 hover:bg-red-700 text-white rounded">
        ä¸€æ‹¬å‰Šé™¤
      </button>
    </form>
    {% endif %}
  </div>

  <!-- è¨˜äº‹ä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ« -->
  <table class="w-full table-auto">
    <thead>
      <tr class="border-b">
        <th class="px-2 py-2">ID</th>
        <th class="px-2 py-2">ã‚¿ã‚¤ãƒˆãƒ«</th>
        <th class="px-2 py-2">çŠ¶æ…‹</th>
        <th class="px-2 py-2">ä½œæˆæ—¥</th>
      </tr>
    </thead>
    <tbody>
      {% for a in articles %}
      <tr class="border-b hover:bg-gray-100">
        <td class="px-2 py-2">{{ a.id }}</td>
        <td class="px-2 py-2">{{ a.title[:30] }}...</td>
        <td class="px-2 py-2">
          {{ a.status }}
          {% if a.status == 'posted' and a.posted_url %}
            <a href="{{ a.posted_url }}" target="_blank"
               class="ml-2 text-blue-600 underline hover:text-blue-800"
               title="æŠ•ç¨¿ã•ã‚ŒãŸWordPressè¨˜äº‹ã‚’é–‹ã">View</a>
          {% endif %}
        </td>
        <td class="px-2 py-2">{{ a.created_at.strftime('%Y-%m-%d') }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
